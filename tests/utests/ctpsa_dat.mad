--[=[
 o-----------------------------------------------------------------------------o
 |
 | GTPSA module regression tests - data for real tpsa
 |
 | Methodical Accelerator Design - Copyright CERN 2016+
 | Support: http://cern.ch/mad  - mad at cern.ch
 | Authors: L. Deniau, laurent.deniau at cern.ch
 | Contrib: -
 |
 o-----------------------------------------------------------------------------o
 | You can redistribute this file and/or modify it under the terms of the GNU
 | General Public License GPLv3 (or later), as published by the Free Software
 | Foundation. This file is distributed in the hope that it will be useful, but
 | WITHOUT ANY WARRANTY OF ANY KIND. See http://gnu.org/licenses for details.
 o-----------------------------------------------------------------------------o

  Purpose:
  - Provide mathematica created output regression test suites for the tpsa
    module.

 o-----------------------------------------------------------------------------o
]=]

local is_even, is_odd in MAD.typeid
local eps, pi         in MAD.constant
local fact            in MAD.gmath

-- locals ---------------------------------------------------------------------o

local M = {}

-- differential algebra of functions, single variable, order 15 ---------------o

-- Note about numerical stability:
-- sinc has problem for x0 in (0, 0.5)
-- atan, acot, atanh and acoth are inaccurate close to 0 for high orders (>10)
--   because they rely on complex version of logxdy which is inaccurate close to 1i

--[=[ coefficients were computed with Mathematica using:
Eform[x_?NumericQ, ndig_Integer: 20] :=
 Module[{u, s, p, base, exp, sign, result},
  u = If[x == 0, u = 0, u = x];
  {s, p} = MantissaExponent[u];
  If[s != 0, {s = s*10; p = p - 1}];
  base = ToString[PaddedForm[s, {ndig + 2, ndig}]];
  exp = If[p >= 0, ToString[p], ToString[-1*p]];
  If[StringLength[exp] < 2, exp = StringJoin["0", exp], exp = exp];
  sign = If[p >= 0, "e+", "e-"];
  result = StringJoin[base, sign, exp];
  result]
Dform[z_Complex, ndig_Integer: 20] :=
 If[NonNegative[Re[z]], " ", ""] <>
  StringReplace[
   StringReplace[
    Eform[Re[z], ndig] <> "+" <> Eform[Im[z], ndig] <>
     "i,", {" " -> ""}],
   {"+-" -> "-"}]
data1 = N[Table[SeriesCoefficient[Sin[x], {x, Pi/3, n}], {n, 0, 15}], 25]
Export["data1.dat", Dform /@ data1]
FilePrint["data1.dat"]
--]=]

M.fun = {}

M.fun.inv = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

iter = {32998215, 4912145, 1793298, 764146, 349502, 171287, 88635, 48536, 28396,
  17123, 10595, 6835, 4524, 3110, 2122},

{ x0 = 0.001,
1000, -1e6, 1e9, -1e12, 1e15, -1e18, 1e21, -1e24, 1e27, -1e30, 1e33, -1e36,
1e39, -1e42, 1e45, -1e48},

{ x0 = 0.1,
10, -100, 1000, -10000, 100000, -1e6, 1e7, -1e8, 1e9, -1e10, 1e11, -1e12, 1e13,
-1e14, 1e15, -1e16},

{ x0 = 1,
1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1},

{ x0 = 10,
0.1, -0.01, 0.001, -0.0001, 0.00001, -1e-6, 1e-7, -1e-8, 1e-9, -1e-10, 1e-11,
-1e-12, 1e-13, -1e-14, 1e-15, -1e-16},

{ x0 = pi/5,
1.5915494309189535, -2.5330295910584444, 4.031441804149937, -6.41623890917771,
10.211761384541832, -16.252523020247697, 25.866693763872416, -41.16812173964597,
65.52110072673574, -104.2800705748197, 165.96688697954258, -264.1445045236813,
420.39903585503396, -669.0858462739559, 1064.883197873241, -1694.8142475703114},

{ x0 = pi/3,
0.954929658551372, -0.91189065278104, 0.8707914296963863, -0.8315445626294312,
0.7940665652619728, -0.7582777140326765, 0.7241018785483389,
-0.6914663596385721, 0.6603017347094219, -0.6305417100669469,
0.6021229798966278, -0.5749850915986215, 0.5490703171924012,
-0.5243235305172331, 0.5006920899672713, -0.4781257265118191},

}

M.fun.invsqrt = {
alt = \x -> x:sqrt():inv(),

iter = {32252662, 4816722, 1754072, 764146, 345464, 169779, 88635, 48368, 27995,
  16963, 10589, 6672, 4550, 3122, 2170},

{ x0 = 0.001,
31.622776601683796, -15811.388300841898, 1.1858541225631423e7,
-9.882117688026186e9, 8.646852977022913e12, -7.782167679320622e15,
7.133653706043903e18, -6.624107012755052e21, 6.210100324457861e24,
-5.865094750876869e27, 5.571840013333026e30, -5.318574558181525e33,
5.096967284923961e36, -4.9009300816576556e39, 4.725896864455596e42,
-4.568366968973743e45},

{ x0 = 0.1,
3.162277660168379, -15.811388300841895, 118.58541225631421, -988.2117688026185,
8646.85297702291, -77821.6767932062, 713365.3706043902, -6.624107012755052e6,
6.2101003244578615e7, -5.865094750876869e8, 5.571840013333025e9,
-5.318574558181524e10, 5.0969672849239606e11, -4.900930081657655e12,
4.725896864455595e13, -4.568366968973742e14},

{ x0 = 1,
1, -0.5, 0.375, -0.3125, 0.2734375, -0.24609375, 0.2255859375, -0.20947265625,
0.196380615234375, -0.1854705810546875, 0.17619705200195312,
-0.16818809509277344, 0.1611802577972412, -0.15498101711273193,
0.14944598078727722, -0.14446444809436798},

{ x0 = 10,
0.31622776601683794, -0.0158113883008419, 0.0011858541225631422,
-0.00009882117688026186, 8.646852977022913e-6, -7.782167679320622e-7,
7.133653706043903e-8, -6.624107012755053e-9, 6.210100324457863e-10,
-5.865094750876869e-11, 5.571840013333026e-12, -5.318574558181525e-13,
5.096967284923961e-14, -4.900930081657655e-15, 4.725896864455596e-16,
-4.568366968973743e-17},

{ x0 = pi/5,
1.2615662610100802, -1.0039225323885723, 1.1983442513323102,
-1.5893534260441147, 2.2133427231558995, -3.170379916320641, 4.625331655648912,
-6.8356265383337735, 10.199285181618384, -15.33085171955236, 23.1798179132686,
-35.21492482645543, 53.71103133542393, -82.19592438073465, 126.14677393372928,
-194.07653205760573},

{ x0 = pi/3,
0.9772050238058398, -0.466581029858798, 0.3341640476472071,
-0.26591929993324326, 0.22219244800153787, -0.19096034265252188,
0.16715755357219025, -0.14822201230290474, 0.13269524587332193,
-0.11967492439802378, 0.10856707795793781, -0.09896147165318948,
0.09056369248820814, -0.08315572687011161, 0.07657187451428586,
-0.07068339551841332},

}

M.fun.sqrt = {
iter = {32998215, 4816722, 1754072, 764146, 345464, 169779, 88635, 48368, 27995,
  16963, 10313, 6747, 4524, 3081, 2122},

{ x0 = 0.001,
0.03162277660168379, 15.811388300841896, -3952.847075210474,
1.976423537605237e6, -1.235264711003273e9, 8.646852977022911e11,
-6.485139732767184e14, 5.0954669328885005e17, -4.140066882971907e20,
3.450055735809921e23, -2.932547375438433e26, 2.53265455151501e29,
-2.2160727325756336e32, 1.9603720326630605e35, -1.7503321720205893e38,
1.5752989548185305e41},

{ x0 = 0.1,
0.31622776601683794, 1.5811388300841898, -3.952847075210474, 19.764235376052373,
-123.52647110032733, 864.6852977022912, -6485.139732767184, 50954.66932888502,
-414006.68829719076, 3.450055735809923e6, -2.9325473754384346e7,
2.5326545515150118e8, -2.2160727325756354e9, 1.960372032663062e10,
-1.750332172020591e11, 1.5752989548185317e12},

{ x0 = 1,
1, 0.5, -0.125, 0.0625, -0.0390625, 0.02734375, -0.0205078125, 0.01611328125,
-0.013092041015625, 0.0109100341796875, -0.009273529052734375,
0.008008956909179688, -0.0070078372955322266, 0.006199240684509277,
-0.005535036325454712, 0.004981532692909241},

{ x0 = 10,
3.1622776601683795, 0.15811388300841897, -0.003952847075210475,
0.0001976423537605237, -0.000012352647110032732, 8.646852977022912e-7,
-6.485139732767185e-8, 5.095466932888502e-9, -4.140066882971908e-10,
3.450055735809923e-11, -2.932547375438435e-12, 2.5326545515150116e-13,
-2.216072732575635e-14, 1.960372032663062e-15, -1.750332172020591e-16,
1.575298954818532e-17},

{ x0 = pi/5,
0.7926654595212022, 0.6307831305050401, -0.2509806330971431,
0.19972404188871837, -0.19866917825551433, 0.22133427231558994,
-0.2641983263600534, 0.3303808325463509, -0.42722665864586085,
0.5666269545343547, -0.766542585977618, 1.0536280869667545, -1.467288534435643,
2.065808897516305, -2.9355687278833806, 4.204892464457642},

{ x0 = pi/3,
1.0233267079464885, 0.4886025119029199, -0.1166452574646995,
0.05569400794120118, -0.03323991249165541, 0.022219244800153786,
-0.015913361887710156, 0.011939825255156447, -0.009263875768931546,
0.00737195810407344, -0.005983746219901189, 0.004934867179906264,
-0.004123394652216228, 0.003483218941854159, -0.0029698473882182716,
0.002552395817142862},

}

M.fun.exp = {
neg = \x,i -> i > 2 and 1/(x*fact(i-1)^2) or 1/x,

iter = {22801917, 4674516, 1716840, 762399, 347282, 169668, 88244, 48643, 27954,
  16973, 10415, 6748, 4511, 3062, 2138},

{ x0 = 0,
1, 1, 0.5, 0.16666666666666666, 0.041666666666666664, 0.008333333333333333,
0.001388888888888889, 0.0001984126984126984, 0.0000248015873015873,
2.7557319223985893e-6, 2.755731922398589e-7, 2.505210838544172e-8,
2.08767569878681e-9, 1.6059043836821613e-10, 1.1470745597729725e-11,
7.647163731819816e-13},

{ x0 = 0.001,
1.0010005001667084, 1.0010005001667084, 0.5005002500833542, 0.1668334166944514,
0.04170835417361285, 0.00834167083472257, 0.0013902784724537617,
0.00019861121035053738, 0.000024826401293817172, 2.7584890326463526e-6,
2.7584890326463524e-7, 2.507717302405775e-8, 2.089764418671479e-9,
1.607511091285753e-10, 1.1482222080612523e-11, 7.654814720408348e-13},

{ x0 = 0.1,
1.1051709180756477, 1.1051709180756477, 0.5525854590378239, 0.18419515301260794,
0.046048788253151986, 0.009209757650630397, 0.0015349596084383997,
0.0002192799440626285, 0.000027409993007828564, 3.0455547786476183e-6,
3.045554778647618e-7, 2.768686162406926e-8, 2.3072384686724384e-9,
1.7747988220557215e-10, 1.2677134443255153e-11, 8.451422962170103e-13},

{ x0 = 1,
2.718281828459045, 2.718281828459045, 1.3591409142295225, 0.45304697140984085,
0.11326174285246021, 0.02265234857049204, 0.0037753914284153404,
0.0005393416326307629, 0.00006741770407884536, 7.490856008760597e-6,
7.490856008760595e-7, 6.80986909887327e-8, 5.674890915727725e-9,
4.3653007044059413e-10, 3.11807193171853e-11, 2.0787146211456865e-12},

{ x0 = 10,
22026.465794806718, 22026.465794806718, 11013.232897403359, 3671.0776324677863,
917.7694081169466, 183.55388162338932, 30.59231360389822, 4.370330514842602,
0.5462913143553253, 0.060699034928369484, 0.006069903492836948,
0.0005518094084397226, 0.00004598411736997688, 3.537239797690529e-6,
2.526599855493235e-7, 1.6843999036621567e-8},

{ x0 = pi/5,
1.8744560875853382, 1.8744560875853382, 0.9372280437926691, 0.3124093479308897,
0.07810233698272243, 0.015620467396544485, 0.0026034112327574144,
0.0003719158903939163, 0.00004648948629923954, 5.165498477693282e-6,
5.165498477693282e-7, 4.695907706993893e-8, 3.913256422494911e-9,
3.010197248073008e-10, 2.15014089148072e-11, 1.4334272609871468e-12},

{ x0 = pi/3,
2.849653908226361, 2.849653908226361, 1.4248269541131806, 0.47494231803772685,
0.11873557950943171, 0.023747115901886343, 0.00395785265031439,
0.0005654075214734844, 0.00007067594018418555, 7.852882242687284e-6,
7.852882242687283e-7, 7.138983856988439e-8, 5.9491532141570325e-9,
4.576271703197717e-10, 3.268765502284084e-11, 2.1791770015227227e-12},

}

M.fun.log = {
iter = {25350958, 4738782, 1701485, 764652, 347981, 169754, 88623, 48557, 28050,
  16954, 10347, 6754, 4502, 3074, 2134},

{ x0 = 0.001,
-6.907755278982137, 1000, -500000, 3.333333333333333e8, -2.5e11, 2e14,
-1.6666666666666666e17, 1.4285714285714286e20, -1.25e23, 1.111111111111111e26,
-1.0000000000000001e29, 9.090909090909092e31, -8.333333333333333e34,
7.692307692307693e37, -7.142857142857142e40, 6.666666666666667e43},

{ x0 = 0.1,
-2.3025850929940455, 10, -50, 333.3333333333333, -2500, 20000,
-166666.66666666666, 1.4285714285714286e6, -1.25e7, 1.111111111111111e8, -1e9,
9.09090909090909e9, -8.333333333333333e10, 7.692307692307693e11,
-7.142857142857143e12, 6.6666666666666664e13},

{ x0 = 1,
0, 1, -0.5, 0.3333333333333333, -0.25, 0.2, -0.16666666666666666,
 0.14285714285714285, -0.125, 0.1111111111111111, -0.1, 0.09090909090909091,
 -0.08333333333333333, 0.07692307692307693, -0.07142857142857142,
 0.06666666666666667},

{ x0 = 10,
2.3025850929940455, 0.1, -0.005, 0.0003333333333333333, -0.000025, 2e-6,
-1.6666666666666668e-7, 1.4285714285714286e-8, -1.25e-9, 1.1111111111111111e-10,
-1e-11, 9.090909090909091e-13, -8.333333333333334e-14, 7.692307692307692e-15,
-7.142857142857143e-16, 6.666666666666667e-17},

{ x0 = pi/5,
-0.4647080265847001, 1.5915494309189535, -1.2665147955292222,
1.3438139347166456, -1.6040597272944275, 2.042352276908366, -2.7087538367079493,
3.695241966267488, -5.146015217455746, 7.2801223029706374, -10.42800705748197,
15.08789881632205, -22.012042043640108, 32.33838737346415, -47.79184616242542,
70.9922131915494},

{ x0 = pi/3,
0.04611759718129038, 0.954929658551372, -0.45594532639052, 0.29026380989879547,
-0.2078861406573578, 0.15881331305239457, -0.1263796190054461,
0.10344312550690556, -0.08643329495482151, 0.07336685941215798,
-0.06305417100669469, 0.05473845271787525, -0.047915424299885136,
0.042236178245569314, -0.03745168075123093, 0.03337947266448476},

}

M.fun.sin = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

iter = {21191774, 4268294, 1718221, 766545, 345516, 170166, 88501, 48583, 28124,
  16994, 10405, 6734, 4480, 3083, 2136},

{ x0 = 0,
0, 1, 0, -0.16666666666666666, 0, 0.008333333333333333, 0,
-0.0001984126984126984, 0, 2.7557319223985893e-6, 0, -2.505210838544172e-8, 0,
1.6059043836821613e-10, 0, -7.647163731819816e-13},

{ x0 = 0.001,
0.0009999998333333417, 0.9999995000000417, -0.0004999999166666708,
-0.16666658333334028, 0.00004166665972222257, 0.008333329166667014,
-1.388888657407419e-6, -0.00019841259920635746, 2.4801583167989625e-8,
2.755730544532743e-6, -2.755731463109958e-10, -2.5052095859388573e-8,
2.0876753508408775e-12, 1.6059035807300365e-10, -1.1470743685938888e-14,
-7.647159908238269e-13},

{ x0 = 0.1,
0.09983341664682815, 0.9950041652780258, -0.04991670832341408,
-0.16583402754633764, 0.00415972569361784, 0.008291701377316881,
-0.00013865752312059468, -0.00019742146136468767, 2.4760271985820474e-6,
2.7419647411762177e-6, -2.7511413317578304e-8, -2.492695219251107e-8,
2.0841979786044172e-10, 1.5978815508019914e-10, -1.1451637245079215e-12,
-7.60895976572377e-13},

{ x0 = 1,
0.8414709848078965, 0.5403023058681398, -0.42073549240394825,
-0.09005038431135662, 0.03506129103366235, 0.004502519215567831,
-0.0011687097011220786, -0.00010720283846590075, 0.000020869816091465686,
1.4889283120263993e-6, -2.3188684546072984e-7, -1.353571192751272e-8,
1.7567185262176504e-9, 8.676738415072256e-11, -9.652299594602475e-12,
-4.1317801976534555e-13},

{ x0 = 10,
-0.5440211108893698, -0.8390715290764524, 0.2720105554446849,
0.1398452548460754, -0.022667546287057073, -0.0069922627423037705,
0.0007555848762352359, 0.00016648244624532788, -0.00001349258707562921,
-2.312256197851776e-6, 1.4991763417365788e-7, 2.10205108895616e-8,
-1.1357396528307417e-9, -1.347468646766769e-10, 6.240327762806272e-12,
6.416517365556044e-13},

{ x0 = pi/5,
0.5877852522924731, 0.8090169943749475, -0.29389262614623657,
-0.1348361657291579, 0.024491052178853046, 0.006741808286457894,
-0.0008163684059617683, -0.00016051924491566416, 0.00001457800724931729,
2.2294339571620023e-6, -1.6197785832574765e-7, -2.0267581428745475e-8,
1.2271049873162703e-9, 1.2992039377400946e-10, -6.742335095144342e-12,
-6.186685417809974e-13},

{ x0 = pi/3,
0.8660254037844386, 0.5, -0.4330127018922193, -0.08333333333333333,
0.036084391824351615, 0.004166666666666667, -0.0012028130608117205,
-0.0000992063492063492, 0.000021478804657352153, 1.3778659611992946e-6,
-2.386533850816906e-7, -1.252605419272086e-8, 1.8079801900128075e-9,
8.029521918410807e-11, -9.933957087982458e-12, -3.823581865909908e-13},

}

M.fun.cos = {
neg = \x,i -> is_even(i) and -x or x, -- even function

iter = {21224463, 4578710, 1677585, 760719, 342956, 169433, 88241, 48735, 28164,
  16930, 10399, 6737, 4494, 3074, 2144},

{ x0 = 0,
1, 0, -0.5, 0, 0.041666666666666664, 0, -0.001388888888888889, 0,
0.0000248015873015873, 0, -2.755731922398589e-7, 0, 2.08767569878681e-9, 0,
-1.1470745597729725e-11, 0},

{ x0 = 0.001,
0.9999995000000417, -0.0009999998333333417, -0.49999975000002084,
0.00016666663888889027, 0.04166664583333507, -8.333331944444515e-6,
-0.0013888881944445024, 1.98412665343917e-7, 0.000024801574900794683,
-2.7557314631099586e-9, -2.7557305445327426e-7, 2.505210421009053e-11,
2.0876746549490476e-9, -1.605904116031444e-13, -1.1470739862357404e-11,
7.647162457292591e-16},

{ x0 = 0.1,
0.9950041652780258, -0.09983341664682815, -0.4975020826390129,
0.01663890277447136, 0.04145850688658441, -0.000831945138723568,
-0.0013819502295528137, 0.00001980821758865638, 0.00002467768267058596,
-2.751141331757831e-7, -2.741964741176217e-7, 2.5010375743253005e-9,
2.077246016042589e-9, -1.60322921431109e-11, -1.1413439648585655e-11,
7.63442483005281e-14},

{ x0 = 1,
0.5403023058681398, -0.8414709848078965, -0.2701511529340699,
0.1402451641346494, 0.022512596077839155, -0.007012258206732471,
-0.0007504198692613053, 0.00016695852873172549, 0.000013400354808237594,
-2.3188684546072986e-6, -1.488928312026399e-7, 2.1080622314611807e-8,
1.1279759939593935e-9, -1.3513219432443465e-10, -6.197670296480184e-12,
6.434866396401649e-13},

{ x0 = 10,
-0.8390715290764524, 0.5440211108893698, 0.4195357645382262,
-0.09067018514822829, -0.03496131371151885, 0.004533509257411415,
0.001165377123717295, -0.00010794069660503368, -0.000020810305780665985,
1.499176341736579e-6, 2.3122561978517758e-7, -1.36288758339689e-8,
-1.7517092407968e-9, 8.736458867928781e-11, 9.624776048334065e-12,
-4.160218508537515e-13},

{ x0 = pi/5,
0.8090169943749475, -0.5877852522924731, -0.4045084971874737,
0.09796420871541218, 0.03370904143228948, -0.00489821043577061,
-0.0011236347144096492, 0.00011662405799453832, 0.00002006490561445802,
-1.6197785832574767e-6, -2.2294339571620023e-7, 1.4725259847795243e-8,
1.6889651190621232e-9, -9.439269133202078e-11, -9.28002812671496e-12,
4.494890063429561e-13},

{ x0 = pi/3,
0.5, -0.8660254037844386, -0.25, 0.14433756729740646, 0.020833333333333332,
-0.0072168783648703235, -0.0006944444444444445, 0.00017183043725881722,
0.00001240079365079365, -2.386533850816906e-6, -1.3778659611992944e-7,
2.169576228015369e-8, 1.043837849393405e-9, -1.390753992317544e-10,
-5.735372798864862e-12, 6.622638058654972e-13},

}

M.fun.tan = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
alt = \x => local s, c = x:sincos() return s/c end,

iter = {18004754, 4347329, 1690648, 754983, 345898, 170582, 4012, 1444, 583,
  242, 107, 48, 24, 12, 6},

{ x0 = 0,
0, 1, 0, 0.3333333333333333, 0, 0.13333333333333333, 0, 0.05396825396825397, 0,
 0.021869488536155203, 0, 0.008863235529902197, 0, 0.003592128036572481, 0,
 0.0014558343870513183},

{ x0 = 0.001,
0.0010000003333334668, 1.0000010000006667, 0.0010000013333344667,
0.3333346666685556, 0.0006666685555583113, 0.13333446666942228,
0.0003777796148189098, 0.05396904127276616, 0.00019682685926388237,
0.02186997601667774, 0.00009749661818191454, 0.008863515717876276,
0.00004669832688373951, 0.0035922809005873957, 0.00002183791702721023,
0.0014559146317101575},

{ x0 = 0.1,
0.10033467208545054, 1.0100670464224948, 0.10134474588712056,
0.34685740732033266, 0.06858340618626864, 0.14494636370859104,
0.03965638673226104, 0.06214001554805846, 0.02119215558852952,
0.027008537356831962, 0.010821796330014097, 0.011871303182623437,
0.0053699159412820665, 0.005267870515949593, 0.002613935926427253,
0.0023564150724195896},

{ x0 = 1,
1.5574077246549023, 3.42551882081476, 5.3349294724876595, 9.450499977879637,
16.496591491563283, 28.918208319192757, 50.654858838289066, 88.74693210502099,
155.47799232394132, 272.3882898480356, 477.2073301926714, 836.0379088599573,
1464.6868853647572, 2566.0411994246133, 4495.546093657309, 7875.919804461862},

{ x0 = 10,
0.6483608274590866, 1.4203717625834316, 0.920913411288115, 1.0705414355554095,
1.0010682680819822, 1.0374644127681036, 1.0268054502887463, 1.0383577897948313,
1.0396939838251535, 1.0458371835905813, 1.0497759872211256, 1.05477326571969,
1.0593079937993137, 1.064088834159303, 1.0687856546127485, 1.073552412870545},

{ x0 = pi/5,
0.7265425280053608, 1.5278640450004206, 1.110058205703102, 1.3157925100047667,
1.3259986184504164, 1.4359444260488465, 1.5099421929869434, 1.6081587683050493,
1.703525766788764, 1.8087548195505092, 1.9185747715923172, 2.035931472219691,
2.160071860769636, 2.291961295882085, 2.4318219620851096, 2.580254380051894},

{ x0 = pi/3, eps = 2*eps,
1.7320508075688772, 4, 6.928203230275509, 13.333333333333334,
25.403411844343537, 48.53333333333334, 92.68396321390792, 177.01587301587307,
338.07432334147575, 645.6747795414461, 1233.147838193409, 2355.1389450056117,
4497.984034801707, 8590.516725414504, 16406.678403513375, 31334.447612884862},

}

M.fun.cot = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
alt = \x => local s, c = x:sincos() return c/s end,
-- alt = \x -> x:tan():inv(), -- very inaccurate

iter = {19614758, 3977509, 1158887, 290886, 70897, 21814, 7222, 2715, 1064, 467,
  208, 99, 47, 25, 13},

{ x0 = 0.001, eps = 225*eps, n_eps = 775*eps, -- inaccurate (inf @ 0)
9.99999666666644444442e2, -1.000000333333498e6, 9.999999999999334e8,
-1.0000000000000222222e12, 1e15, -1e18, 1e21, -1e24, 1e27, -1e30, 1e33, -1e36,
1e39, -1e42, 1e45, -1e48},

{ x0 = 0.1, eps = 11*eps,
9.966644423259238, -100.33400105968447, 999.9933121247907, -10000.022434604973,
99999.99893436453, -1.000000002161117e6, 9.999999999850044e6,
-1.000000000002194e8, 1e9, -1e10, 1e11, -1e12, 1e13, -1e14, 1e15, -1e16},

{ x0 = 1,
0.6420926159343306, -1.4122829274373918, 0.9068164393176694,
-1.0530211155062015, 0.9784092291286872, -1.010620444941762, 0.9951998113482169,
-1.0022733597032414, 0.9989472094078813, -1.0004934908550356,
0.9997700634540057, -1.0001074793488396, 0.9999498417873334,
-1.0000234275946356, 0.9999890623104046, -1.0000051076565317},

{ x0 = 10, eps = 2*eps,
1.5423510453569202, -3.3788467471135846, 5.211367812511467, -9.164040842404328,
15.871290577146318, -27.6088673768957, 47.98880382586913, -83.429333889016,
145.03731297513826, -252.14186952739618, 438.33815786629185, -762.0330342220994,
1324.7632516340245, -2303.0467664572634, 4003.752650457999, -6960.360310077886},

{ x0 = pi/5, eps = 2*eps,
1.3763819204711736, -2.894427190999916, 3.9838372558124497, -6.448090636666387,
10.202981125804557, -16.25688290626592, 25.86520314079862, -41.16877561593458,
65.52085714147945, -104.28017178305558, 165.96684786267835, -264.14452039029203,
420.3990296226343, -669.0858487750638, 1064.8831968837503, -1694.8142479655176},

{ x0 = pi/3, eps = 2*eps,
0.5773502691896258, -1.3333333333333333, 0.769800358919501, -0.8888888888888888,
0.7698003589195008, -0.7703703703703704, 0.7184803349915342,
-0.6941798941798942, 0.6590142755194459, -0.6311581422692534,
0.6018291059997116, -0.5751255054958758, 0.5490032997438921,
-0.5243555347259051, 0.5006768105072897, -0.47813302224589704},

}

M.fun.sinc = { -- series is unstable except at 0 and > 0.5
neg = \x,i -> is_even(i) and -x or x, -- even function
alt = \x -> x:get(1) > 0 and x:sin()/x or x:sinc(),

{ x0 = 0,
1, 0, -0.16666666666666666, 0, 0.008333333333333333, 0, -0.0001984126984126984,
0, 2.7557319223985893e-6, 0, -2.505210838544172e-8, 0, 1.6059043836821613e-10,
0, -7.647163731819816e-13, 0},

{ x0 = 0.001, eps = 1e14*eps, omax = 5, -- problem...
 9.999998333333416666664e-1,  -3.333333000000011904761e-4,
-1.666666166666696428570e-1,   3.333332936507951940034e-5,
 8.333330357143050044086e-3,  -1.190476036155209135000e-6,
-1.984126212522098464805e-4,   2.204585237293583345666e-8,
 2.755730795053791212643e-6,  -2.505210485245222777051e-10,
-2.505209778647355195385e-8,   1.927084982061846194130e-12,
 1.605903687790313032856e-10, -1.070602765013175106717e-14,
-7.647160358071362812707e-13,  4.498330936149027442460e-17},

{ x0 = 0.1, eps = 5e5*eps, omax = 9, -- problem...
 9.983341664682815230681e-1,  -3.330001190255756972580e-2,
-1.661669642085650642761e-1,   3.329366622274365934777e-3,
 8.303590713434737446736e-3,  -1.188933611785606260651e-4,
-1.976416194203402991654e-4,   2.201580556526471623402e-6,
 2.744466420555758048420e-6,  -2.501679379540659488165e-8,
-2.494619522171709876623e-8,   1.924302920603159412748e-10,
 1.598950580012576143938e-10, -1.069029210584658546091e-12,
-7.613451392326289739364e-13,  4.491626602520761309708e-15},

{ x0 = 1,
0.8414709848078965, -0.30116867893975674, -0.11956681346419151,
0.029516429152834922, 0.005544861880827423, -0.001042342665259599,
-0.00012636703586249576, 0.0000191641973965595, 1.7056186949471197e-6,
-2.1669038291483034e-7, -1.519646253278495e-8, 1.6607506481136625e-9,
9.596784478205223e-11, -9.200473716219904e-12, -4.518607710224387e-13,
3.8691272408186705e-14},

{ x0 = 10,
-0.05440211108893698, -0.07846694179875155, 0.035047749724343644,
0.010479750512173177, -0.0033147296799230248, -0.0003677533062380745,
0.00011233381824733104, 5.414862799799683e-6, -1.8907449875428894e-6,
-4.215112103088868e-8, 1.9206875520454654e-8, 1.8136353691069438e-10,
-1.3171031897414361e-10, -3.0365457025333193e-13, 6.543982333059604e-13,
-1.2746496750356032e-15},

{ x0 = pi/5, eps = 152*eps,
0.9354892837886392, -0.20128690024337817, -0.1473865903605307,
0.019974621179853005, 0.007188123186243844, -0.0007103322247641319,
-0.00016876182383970817, 0.000013118471804712817, 2.3229228094806542e-6,
-1.4879214035867783e-7, -2.0985733852063593e-8, 1.1429214900882112e-9,
1.3393563905519934e-10, -6.312813986830701e-12, -5.951107662216515e-13,
4.305925191058768e-13},

{ x0 = pi/3,
0.8269933431326881, -0.3122556415062695, -0.11531449844202252,
0.030539763077315523, 0.005294730436201128, -0.001077221550265836,
-0.00011993105828236525, 0.00001979063936181566, 1.6120791092814196e-6,
-2.2365708152605884e-7, -1.4320415018848238e-8, 1.7134881957325127e-9,
9.02331794488476e-11, -9.489857182953636e-12, -4.2404804270572676e-13,
3.986130612328338e-14},

}

M.fun.sinh = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

{ x0 = 0,
0, 1, 0, 0.16666666666666666, 0, 0.008333333333333333, 0, 0.0001984126984126984,
0, 2.7557319223985893e-6, 0, 2.505210838544172e-8, 0, 1.6059043836821613e-10, 0,
7.647163731819816e-13},

{ x0 = 0.001,
0.001000000166666675, 1.0000005000000416, 0.0005000000833333375,
0.1666667500000069,  0.00004166667361111146, 0.008333337500000346,
1.3888891203703822e-6,  0.00019841279761905587, 2.4801591435185393e-8,
2.755733300264665e-6,  2.755732381687266e-10, 2.5052120911496956e-8,
2.0876760467327775e-12,  1.60590518663442e-10, 1.1470747509520753e-14,
7.647167555402e-13},

{ x0 = 0.1,
0.10016675001984403, 1.0050041680558035, 0.050083375009922014,
0.16750069467596723,  0.004173614584160167, 0.008375034733798362,
0.00013912048613867227,  0.00019940558889996101, 2.4842943953334334e-6,
2.7695220680550143e-6,  2.7603271059260367e-8, 2.5177473345954675e-8,
2.091156898428816e-10,  1.6139405990996585e-10, 1.1489873068290198e-12,
7.685431424284088e-13},

{ x0 = 1,
1.1752011936438014, 1.5430806348152437, 0.5876005968219007, 0.2571801058025406,
0.04896671640182505, 0.012859005290127032, 0.0016322238800608353,
0.00030616679262207217, 0.000029146855001086344, 4.252316564195447e-6,
3.238539444565149e-7, 3.86574233108677e-8, 2.4534389731554164e-9,
2.478039955824852e-10, 1.3480433918436352e-11, 1.180019026583263e-12},

{ x0 = 10,
11013.232874703393, 11013.232920103323, 5506.616437351697, 1835.5388200172204,
458.8847031126414, 91.77694100086102, 15.29615677042138, 2.1851652619252624,
0.2731456566146675, 0.03034951752673976, 0.003034951740162972,
0.0002759047047885433,  0.000022992058637598276, 1.7686199024906617e-6,
1.2632999251427623e-7,  8.421999535669817e-9},

{ x0 = pi/5,
0.6704839982471176, 1.2039720893382209, 0.3352419991235588, 0.20066201488970348,
0.027936833260296563, 0.010033100744485175, 0.0009312277753432188,
0.0002388833510591708, 0.000016629067416843195, 3.3178243202662614e-6,
1.8476741574270213e-7, 3.016203927514783e-8, 1.3997531495659254e-9,
1.9334640560992196e-10, 7.690951371241348e-12, 9.20697169571057e-13},

{ x0 = pi/3,
1.2493670505239751, 1.600286857702386, 0.6246835252619876, 0.266714476283731,
0.05205696043849896, 0.01333572381418655, 0.001735232014616632,
0.00031751723367110836, 0.000030986285975297, 4.409961578765394e-6,
3.442920663921889e-7, 4.009055980695813e-8, 2.6082732302438556e-9,
2.569907679933213e-10, 1.4331171594746458e-11, 1.2237655618729587e-12},

}

M.fun.cosh = {
neg = \x,i -> is_even(i) and -x or x, -- even function

{ x0 = 0,
1, 0, 0.5, 0, 0.041666666666666664, 0, 0.001388888888888889, 0,
0.0000248015873015873, 0, 2.755731922398589e-7, 0, 2.08767569878681e-9, 0,
1.1470745597729725e-11, 0},

{ x0 = 0.001,
1.0000005000000416, 0.001000000166666675, 0.5000002500000208,
0.00016666669444444584, 0.04166668750000173, 8.333334722222292e-6,
0.001388889583333391, 1.9841273148148314e-7, 0.000024801599702381984,
2.7557323816872663e-9, 2.755733300264665e-7, 2.5052112560793327e-11,
2.087676742624746e-9, 1.6059046513329054e-13, 1.1470751333103e-11,
7.64716500634717e-16},

{ x0 = 0.1,
1.0050041680558035, 0.10016675001984403, 0.5025020840279018,
0.01669445833664067, 0.04187517366899181, 0.0008347229168320336,
0.001395839122299727, 0.000019874355162667467, 0.000024925698612495127,
2.7603271059260373e-7, 2.769522068055014e-7, 2.509388278114579e-9,
2.098122778829556e-9, 1.6085822295606273e-11, 1.1528147136426132e-11,
7.659915378860132e-14},

{ x0 = 1,
1.5430806348152437, 1.1752011936438014, 0.7715403174076219, 0.1958668656073002,
0.06429502645063515, 0.009793343280365012, 0.002143167548354505,
0.00023317484000869075, 0.00003827084907775902, 3.2385394445651496e-6,
4.2523165641954466e-7, 2.9441267677864994e-8, 3.221451942572308e-9,
1.8872607485810892e-10, 1.7700285398748945e-11, 8.986955945624235e-13},

{ x0 = 10,
11013.232920103323, 11013.232874703393, 5506.616460051661, 1835.5388124505655,
458.8847050043051, 91.77694062252827, 15.296156833476838, 2.18516525291734,
0.2731456577406578, 0.030349517401629725, 0.0030349517526739754,
0.0002759047036511793,  0.000022992058732378603, 1.7686198951998671e-6,
1.2632999303504725e-7,  8.421999500951748e-9},

{ x0 = pi/5,
1.2039720893382209, 0.6704839982471176, 0.6019860446691104, 0.11174733304118625,
0.05016550372242587, 0.005587366652059313, 0.0016721834574141958,
0.00013303253933474556, 0.00002986041888239635, 1.8476741574270216e-6,
3.317824320266261e-7, 1.6797037794791105e-8, 2.513503272928986e-9,
1.0767331919737886e-10, 1.3810457543565856e-11, 5.127300914160898e-13},

{ x0 = pi/3,
1.600286857702386, 1.2493670505239751, 0.800143428851193, 0.20822784175399583,
0.06667861907093275, 0.010411392087699792, 0.0022226206356977586,
0.000247890287802376, 0.000039689654208888545, 3.4429206639218893e-6,
4.4099615787653937e-7, 3.1299278762926265e-8, 3.3408799839131773e-9,
2.006364023264504e-10, 1.835648342809438e-11, 9.55411439649764e-13},

}

M.fun.tanh = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
alt = \x => local s, c = x:sincosh() return s/c end,

{ x0 = 0,
0, 1, 0, -0.3333333333333333, 0, 0.13333333333333333, 0, -0.05396825396825397,
0, 0.021869488536155203, 0, -0.008863235529902197, 0, 0.003592128036572481, 0,
-0.0014558343870513183},

{ x0 = 0.001,
0.0009999996666668002, 0.9999990000006667, -0.0009999986666678002,
-0.3333320000018889, 0.0006666647777805334, 0.13333220000275559,
-0.0003777759407448357, -0.05396746666959154, 0.00019682393439615756,
0.02186900106076942, -0.00009749456348467759, -0.00886295534590255,
0.00004669700207444724, 0.0035919751753661, -0.000021837114589890532,
-0.0014557541442462092},

{ x0 = 0.1,
0.09966799462495583, 0.9900662908474398, -0.09867792175453258,
-0.3201870663741141, 0.06480504339519978, 0.12227150653786496,
-0.03598107969379072, -0.04638165332340906, 0.01826541384329002,
0.01724440095302928, -0.008764803438584157, -0.006252972248211761,
0.004042695739132174, 0.002197633210898898, -0.001809243323129776,
-0.0007410119896608136},

{ x0 = 1,
0.7615941559557649, 0.41997434161402614, -0.3198500042246123,
0.10360444679521597, 0.027712126864604225, -0.04630744632061434,
0.018922327001822403, 0.0024381682330000686, -0.006871580744122805,
0.003261193417964934, 0.00010097409520653904, -0.000998830319859212,
0.0005469989449778294, -0.000027443297952814644, -0.00014192541321503342,
0.00008977722956931778},

{ x0 = 10, eps = 5*eps,
0.9999999958776927, 8.244614546626394e-9, -8.244614546626394e-9,
5.496409660743495e-9, -2.748204663838294e-9, 1.099282109784383e-9,
-3.6642752042502655e-10, 1.0469330658134635e-10, -2.617251459649572e-11,
5.816400150144424e-12, -1.1637815141912408e-12, 2.1234944124680312e-13,
-3.516596363336167e-14, 5.709678420302367e-15, 1.371736511119125e-15,
9.256604157124566e-16},

{ x0 = pi/5,
0.5568933069002105, 0.6898698447297479, -0.3841838991622841,
-0.016007172847614548, 0.1369755871419927, -0.05561462241156967,
-0.0232245380419294, 0.02965604031032576, -0.00491674812357672,
-0.008203241331974299, 0.005319941204229493, 0.0005303644897353831,
-0.0020915762287553132, 0.0007330033460356634, 0.00040893913867963763,
-0.0004356432606928653},

{ x0 = pi/3,
0.7807144353592677, 0.39048497042165986, -0.3048572531990265,
0.10784480148923531, 0.01742309109857476, -0.04087328210516728,
0.01932805870051245, 0.00010486085980922268, -0.005492172282400057,
0.0031989687601884013, -0.0003386389001043943, -0.000698631512955742,
0.0005055617270651551, -0.00010106664761430932, -0.00008245975606367895,
0.00007681473125579847},

}

M.fun.coth = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
alt = \x -> x:tanh():inv(),

{ x0 = 0.001,
1000.000333333311, -999999.6666667331, 9.99999999999933e8,
-1.0000000000000219e12, 9.999999999999995e14, -9.999999999999995e17,
9.999999999999991e20, -9.999999999999989e23, 9.999999999999992e26,
-9.99999999999999e29, 9.999999999999992e32, -9.999999999999989e35,
9.999999999999987e38, -9.999999999999988e41, 9.999999999999985e44,
-9.999999999999984e47},

{ x0 = 0.1,
10.033311132253989, -99.66733227661182, 999.9933544529868, -10000.022011320956,
100000.00105082047, -999999.9979277734, 9.999999999853631e6,
-1.0000000000020395e8, 1.000000000000018e9, -9.999999999999973e9,
9.99999999999999e10, -9.99999999999999e11, 9.999999999999988e12,
-9.999999999999983e13, 9.999999999999988e14, -9.999999999999984e15},

{ x0 = 1, eps = 16*eps,
1.3130352854993315, -0.7240616609663109, 0.9507185097260202,
-1.0069730628588334, 1.0052849931723107, -1.0004072395311734,
0.9996020856432204, -0.9998885036075124, 1.000015755436238, -1.0000131577052338,
1.0000009795456033, -0.999998970115167, 0.9999997202084367, -1.0000000432493774,
1.0000000337020127, -1.0000000022228184},

{ x0 = 10, eps = 5*eps, -- 3*eps,
1.0000000041223074, -8.244614768671e-9, 8.244614768671e-9,
-5.496409771765798e-9, 2.7482047748605964e-9, -1.0992822208066855e-9,
3.6642736252664083e-10, -1.0469258476015446e-10, 2.6173236417687602e-11,
-5.81613983320281e-12, 1.1641141135364415e-12, -2.1016447147848265e-13,
3.568400443110031e-14, -5.672292027136897e-15, -3.8137602036407097e-16,
1.7041211237482864e-15},

{ x0 = pi/5, eps = 3*eps,
1.795676097395061, -2.224452646755956, 3.9943964475668494, -6.4311580088302165,
10.216811232504948, -16.2517966665688, 25.8661234352155, -41.16812081549274,
65.52115587849636, -104.28007745045723, 165.96688245645873, -264.14450329953235,
420.3990361456021, -669.0858464287985, 1064.8831978638977, -1694.8142475540851},

{ x0 = pi/3, eps = 9*eps, -- 5*eps,
1.2808780710450447, -0.6406486328840746, 0.8205927851061985,
-0.8375297594056172, 0.7992425743015539, -0.7587923366862237,
0.7237416683291429, -0.691349955477681, 0.6603120164014327, -0.6305542858801596,
0.6021244518602482, -0.5749842264221718, 0.5490700175665866,
-0.5243235521674257, 0.5006921214276914, -0.4781257305467015},

}

M.fun.asin = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
alt = \x -> pi/2 - x:acos(),

{ x0 = 0,
0, 1, 0, 0.16666666666666666, 0, 0.075, 0, 0.044642857142857144, 0,
0.030381944444444444, 0, 0.022372159090909092, 0, 0.017352764423076924, 0,
0.01396484375},

{ x0 = 0.001,
0.0010000001666667416, 1.0000005000003749, 0.0005000007500009375,
0.16666741666822918, 0.0003750015625038282, 0.07500093750382814,
0.00031250255209366927, 0.04464395090023998, 0.0002734411914285831,
0.030383174925601737, 0.00024609871293256166, 0.022373512625596247,
0.0002255922915753893, 0.017354230759164223, 0.00020948051158811834,
0.01396641483275833},

{ x0 = 0.1,
0.1001674211615598, 1.005037815259212, 0.05075948561915213, 0.17432550616678508,
0.03910153213188435, 0.08476837603385565, 0.03390849179335017,
0.056349337342051525, 0.03126776108176903, 0.04400014958953077,
0.03001502803538764, 0.03796416574310705, 0.02967917839152538,
0.035047975773906066, 0.03004140804213343, 0.03395225170650682},

{ x0 = pi/5, eps = 2*eps,
0.6793899267509509, 1.2854194372223493, 0.6672436676160017, 1.04669790290108,
1.7258127185347203, 3.28662624772091, 6.638963413248588, 14.063341369698842,
30.777160050933905, 69.06734768381756, 158.0587902753381, 367.46614558255703,
865.4625626805333, 2060.595551296515, 4951.530134486173, 11992.97368562981},

}

M.fun.acos = {
neg = \x,i -> i == 1 and pi-x or is_odd(i) and -x or x, -- odd function
alt = \x -> pi/2 - x:asin(),

{ x0 = 0,
1.5707963267948966, -1, 0, -0.16666666666666666, 0, -0.075, 0,
-0.044642857142857144, 0, -0.030381944444444444, 0, -0.022372159090909092, 0,
-0.017352764423076924, 0, -0.01396484375},

{ x0 = 0.001,
1.56979632662823, -1.0000005000003749, -0.0005000007500009375,
-0.16666741666822918, -0.0003750015625038282, -0.07500093750382814,
-0.00031250255209366927, -0.04464395090023998, -0.0002734411914285831,
-0.030383174925601737, -0.00024609871293256166, -0.022373512625596247,
-0.0002255922915753893, -0.017354230759164223, -0.00020948051158811834,
-0.01396641483275833},

{ x0 = 0.1,
1.4706289056333368, -1.005037815259212, -0.05075948561915213,
-0.17432550616678508, -0.03910153213188435, -0.08476837603385565,
-0.03390849179335017, -0.056349337342051525, -0.03126776108176903,
-0.04400014958953077, -0.03001502803538764, -0.03796416574310705,
-0.02967917839152538, -0.035047975773906066, -0.03004140804213343,
-0.03395225170650682},

{ x0 = pi/5, eps = 2*eps,
0.8914064000439458, -1.2854194372223493, -0.6672436676160017, -1.04669790290108,
-1.7258127185347203, -3.28662624772091, -6.638963413248588, -14.063341369698842,
-30.777160050933905, -69.06734768381756, -158.0587902753381,
-367.46614558255703, -865.4625626805333, -2060.595551296515,
-4951.530134486173, -11992.97368562981},

}

M.fun.atan = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
-- alt = \x -> x:get(1) > 0 and pi/2 - x:inv():atan() or x:atan(), -- very inaccurate

{ x0 = 0, eps = 3730*eps, -- inaccurate for o >= 10
0, 1, 0, -0.3333333333333333333, 0, 0.2, 0, -0.14285714285714285714285, 0,
0.111111111111111111, 0, -0.090909090909090909091, 0, 0.07692307692307692307693,
0, -0.06666666666666666667},

{ x0 = 0.001, eps = 7977*eps, -- SSE2: eps = 947*eps, -- inaccurate for o >= 8
 9.999996666668666665238e-4,  9.999990000009999990000e-1,
-9.999980000029999960000e-4, -3.333313333383333240000e-1,
 9.999950000139999700001e-4,  1.999970000139999580001e-1,
-9.999906667086665346670e-4, -1.428531428871427251433e-1,
 9.999850000989995710014e-4,  1.111061111661107774459e-1,
-9.999780002001988560049e-4, -9.090309100009018109489e-2,
 9.999696670306640146807e-4,  7.691607706307549508661e-2,
-9.999600006119944628927e-4, -6.665866687066408268799e-2},

{ x0 = 0.1, eps = 9825*eps, -- eps = 6241*eps, -- inaccurate for o >= 7
 9.966865249116202737845e-2,  9.900990099009900990099e-1,
-9.802960494069208901088e-2, -3.138241478299383707609e-1,
 9.513705410379881199958e-2,  1.713589703379754579570e-1,
-9.107379319359252573521e-2, -1.057293210548184241730e-1,
 8.594849116810655300166e-2,  6.629127189381281456636e-2,
-7.989229888650648418146e-2, -3.931924835925313795988e-2,
 7.305489564813710770019e-2,  1.958720353360666101129e-2,
-6.560010445297189611256e-2, -4.683389667892097955881e-3},

{ x0 = 1,
0.7853981633974483, 0.5, -0.25, 0.08333333333333333, 0, -0.025,
0.020833333333333332, -0.008928571428571428, 0, 0.003472222222222222, -0.003125,
0.0014204545454545455, 0, -0.0006009615384615385, 0.0005580357142857143,
-0.00026041666666666666},

{ x0 = 10,
1.4711276743037347, 0.009900990099009901, -0.000980296049406921,
0.00009673548474345523, -9.51370541037988e-6, 9.32455403168366e-7,
-9.107379319359253e-8, 8.863618341427544e-9, -8.594849116810656e-10,
8.3027786005476e-11, -7.989229888650648e-12, 7.656128746002212e-13,
-7.30548956481371e-14, 6.939400864394877e-15, -6.560010445297189e-16,
6.169510312289631e-17},

{ x0 = pi/5, eps = 62*eps, -- 48*eps,
0.5609821161086238, 0.7169568003248977, -0.32297272302458013,
0.022646798091021516, 0.10047594428321542, -0.08216146778702756,
0.013661844851056839, 0.03152555896842194, -0.03219892150276071,
0.008206761684756194, 0.011813661702311051, -0.014490068867423883,
0.004908747267453056, 0.004708122540769872, -0.0069554121762498205,
0.0029232914107566645},

{ x0 = pi/3,
0.808448792630022, 0.4769575349168646, -0.23822538977276306,
0.08281869082501257, -0.005236326208189582, -0.019515988977811167,
0.0179110482692886, -0.00868723134533506, 0.0011861441354511198,
0.002169445781852834, -0.0024030190266223148, 0.0013356415621722498,
-0.00026792224417611967, -0.00029198741344877924, 0.0003803752708457477,
-0.0002339428722325455},

}

M.fun.acot = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function
-- alt = \x -> x:inv():atan(), -- very inaccurate

{ x0 = 0.001, eps = 7977*eps, -- SSE2: eps = 947*eps, -- inaccurate for o >= 8
 1.569796327128229752565,    -9.999990000009999990000e-1,
 9.999980000029999960000e-4,  3.333313333383333240000e-1,
-9.999950000139999700001e-4, -1.999970000139999580001e-1,
 9.999906667086665346670e-4,  1.428531428871427251433e-1,
-9.999850000989995710014e-4, -1.111061111661107774459e-1,
 9.999780002001988560049e-4,  9.090309100009018109489e-2,
-9.999696670306640146807e-4, -7.691607706307549508661e-2,
 9.999600006119944628927e-4,  6.665866687066408268798e-2},

{ x0 = 0.1, eps = 9825*eps, -- eps = 6241*eps, -- inaccurate for o >= 7
 1.471127674303734591853,    -9.900990099009900990099e-1,
 9.802960494069208901088e-2,  3.138241478299383707609e-1,
-9.513705410379881199958e-2, -1.713589703379754579570e-1,
 9.107379319359252573521e-2,  1.057293210548184241730e-1,
-8.594849116810655300166e-2, -6.629127189381281456636e-2,
 7.989229888650648418146e-2,  3.931924835925313795988e-2,
-7.305489564813710770019e-2, -1.958720353360666101129e-2,
 6.560010445297189611256e-2,  4.683389667892097955881e-3},

{ x0 = 1,
 7.853981633974483096157e-1, -0.5, 0.25,
-8.333333333333333333333e-2, 0, 0.025,
-2.083333333333333333333e-2, 8.928571428571428571429e-3, 0,
-3.472222222222222222222e-3, 3.125e-3,
-1.420454545454545454545e-3, 0,
 6.009615384615384615385e-4, -5.580357142857142857143e-4,
 2.604166666666666666667e-4},

{ x0 = 10,
9.966865249116202737845e-2 , -9.900990099009900990099e-3,
9.802960494069208901088e-4 , -9.673548474345522975001e-5,
9.513705410379881199958e-6 , -9.324554031683659539537e-7,
9.107379319359252573521e-8 , -8.863618341427543590462e-9,
8.594849116810655300166e-10, -8.302778600547599523589e-11,
7.989229888650648418146e-12, -7.656128746002211759731e-13,
7.305489564813710770019e-14, -6.939400864394876551669e-15,
6.560010445297189611256e-16, -6.169510312289631283398e-17},

{ x0 = pi/5, eps = 62*eps, -- 48*eps,
 1.009814210686272823716,    -7.169568003248977763061e-1,
 3.229727230245801865515e-1, -2.264679809102152927230e-2,
-1.004759442832154290486e-1,  8.216146778702758788593e-2,
-1.366184485105685652305e-2, -3.152555896842197368540e-2,
 3.219892150276072393174e-2, -8.206761684756069553964e-3,
-1.181366170231109360123e-2,  1.449006886742374975231e-2,
-4.908747267453004225552e-3, -4.708122540769758899782e-3,
 6.955412176249300051937e-3, -2.923291410756951933036e-3},

{ x0 = pi/3,
 7.623475341648745879175e-1, -4.769575349168646163308e-1,
 2.382253897727630495100e-1, -8.281869082501256551148e-2,
 5.236326208189586503274e-3,  1.951598897781116427070e-2,
-1.791104826928860386661e-2,  8.687231345335058271891e-3,
-1.186144135451120658186e-3, -2.169445781852861625921e-3,
 2.403019026622202089125e-3, -1.335641562172296526303e-3,
 2.679222441761879808261e-4,  2.919874134487530169866e-4,
-3.803752708458918666970e-4,  2.339428722324616706623e-4},

}

M.fun.asinh = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

{ x0 = 0,
0, 1, 0, -0.16666666666666666, 0, 0.075, 0, -0.044642857142857144, 0,
0.030381944444444444, 0, -0.022372159090909092, 0, 0.017352764423076924, 0,
-0.01396484375},

{ x0 = 0.001,
0.0009999998333334083, 0.999999500000375, -0.0004999992500009375,
-0.16666591666822914, 0.00037499843750382806, 0.07499906250382811,
-0.0003124974479270026, -0.044641763400239926, 0.00027343380861608296,
0.0303807139881016, -0.0002460887871513112, -0.022370805594345962,
0.00022557958356757578,  0.017351298141976196, -0.00020946480113889765,
-0.013963272742913669},

{ x0 = 0.1,
0.09983407889920756, 0.9950371902099892, -0.049259266842078674,
-0.15932040100738315, 0.035975055188068435, 0.06599769576929984,
-0.028798366797720933, -0.03441473770314799, 0.023866961064649934,
0.019250806032431966, -0.020044255670338885, -0.010607330611076061,
0.016872599041027194, 0.005190424412337222, -0.014135257617826545,
-0.0016165440251350639},

{ x0 = 1,
0.881373587019543, 0.7071067811865475, -0.17677669529663687,
0.029462782549439476, 0.011048543456039804, -0.014363106492851746,
0.007826051614694862, -0.0018743064791496098, -0.0009926425761285762,
0.0014649869903733334, -0.0008922993591938396, 0.0002312406001208615,
0.00013565665640706423, -0.00020968381340696784, 0.0001335513209743058,
-0.000035823416339309564},

{ x0 = 10, n_eps = 9*eps,
2.99822295029797, 0.09950371902099892, -0.004925926684207867,
0.0003235179571476454, -0.000023782167355870742, 1.855121408571782e-6,
-1.4993067860177227e-7, 1.2394203833775378e-8, -1.0398198477849702e-9,
8.807313386784527e-11, -7.503127014253594e-12, 6.410456781085834e-13,
-5.4793190444454564e-14, 4.675214431045697e-15, -3.973576040091969e-16,
3.3564380212543216e-17},

{ x0 = pi/5,
0.5929556950394831, 0.8467330159648305, -0.1907169774504193,
-0.015264840710516548, 0.05417419051149325, -0.029241031895687414,
-0.0009563331252082789, 0.013155884121721775, -0.009189668218819422,
0.00048042416832889175, 0.004317308934523752, -0.0036129209507207807,
0.0005032502491571305, 0.0016080598009810907, -0.0015790363389151158,
0.00035255831431756644},

{ x0 = pi/3, n_eps = 2*eps,
0.9143566553928859, 0.6906211225533612, -0.17247183875002062,
0.031244804519616014, 0.007913326204133927, -0.012239543170192373,
0.007156933257849983, -0.0021424834526059993, -0.0004555088022947459,
0.0010746291364070373, -0.0007579694339466041, 0.0002764894629671914,
0.0000322069692441694, -0.0001307471870250451, 0.0001044604876307863,
-0.0000437289096197738},

}

M.fun.acosh = {

{ x0 = 1.001, eps = 617*eps, -- inaccurate (cut @ 1)
0.04471763360830685, 22.355091700494796, -5591.565915091277,
2.795318157116251e6, -1.7470154866500142e9, 1.2228933582311985e12,
-9.171627365273684e14, 7.206242238102538e17, -5.8550513415243124e20,
4.879196938157542e23, -4.1473092641667196e26, 3.5817615464989215e29,
-3.134037425348218e32, 2.7724148521200224e35, -2.475368250975326e38,
2.2278297754873367e41},

{ x0 = 1.1, eps = 4*eps,
0.4435682543851154, 2.182178902359924, -5.715230458561705, 28.20503343186296,
-175.60401975852858, 1227.3234542085509, -9197.27724875981, 72226.67141777194,
-586631.6180241172, 4.88731922484872e6, -4.1533936613147944e7,
3.586458828976266e8, -3.137753433729153e9, 2.7754145013722767e10,
-2.4778310695836972e11, 2.229881300815669e12},

{ x0 = 2,
1.3169578969248168, 0.5773502691896258, -0.19245008972987526,
0.09622504486493763, -0.058804194084128555, 0.04045015774877934,
-0.02999607880048982, 0.023398638555120418, -0.01892079392984692,
0.01571507987945537, -0.013325494931863484, 0.011487171526885573,
-0.010036676142007036, 0.008868156999219508, -0.007910294294951771,
0.0071134348478022885},

{ x0 = 10,
2.993222846126381, 0.10050378152592121, -0.0050759485619152125,
0.00034352379156395884, -0.00002628348020785604, 2.1553840071333643e-6,
-1.849788282438779e-7, 1.6402459466720853e-8, -1.4911616699019427e-9,
1.3828191498499012e-10, -1.3034453765803654e-11, 1.245603952363888e-12,
-1.2043922202174902e-13, 1.176470956643336e-14, -1.1595103851579845e-15,
1.1518582679990107e-16},

{ x0 = pi/3, eps = 8*eps,
0.30604210861326536, 3.2170691066635198, -17.4333075918039, 183.3931030187645,
-2424.377301844406, 35931.46810417419, -570756.2557857943, 9.499283427723804e6,
-1.635017054591562e8, 2.886479955092473e9, -5.1978951071161255e10,
9.510580565542958e11, -1.7630709217451277e13, 3.304330486360936e14,
-6.250691749186932e15, 1.1918891832970331e17},

}

M.fun.atanh = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

{ x0 = 0, eps = 3730*eps, -- inaccurate for o >= 10
0, 1, 0, 0.333333333333333333, 0, 0.2, 0, 0.14285714285714285714, 0,
0.1111111111111111111, 0, 0.09090909090909091, 0, 0.076923076923076930769, 0,
0.0666666666666666667},

{ x0 = 0.001, eps = 3055*eps, -- SSE2: eps = 1901*eps, -- inaccurate for o >= 8
1.000000333333533333476e-3, 1.000001000001000001000,
1.000002000003000004000e-3, 3.333353333383333426667e-1,
1.000005000014000030000e-3, 2.000030000140000420001e-1,
1.000009333375333465334e-3, 1.428611428871429891433e-1,
1.000015000099000429001e-3, 1.111161111661114447792e-1,
1.000022000200201144005e-3, 9.091509100009163709489e-2,
1.000030333697335985347e-3, 7.693007706307835108661e-2,
1.000040000612005537178e-3, 6.667466687066925068798e-2},

{ x0 = 0.1, eps = 7947*eps, -- SSE2: eps = 6788*eps, -- inaccurate for o >= 7
1.003353477310755806357e-1, 1.010101010101010101010,
1.020304050607080910111e-1, 3.538428188974051641126e-1,
1.051430559242068890126e-1, 2.314430103902183845551e-1,
1.097668744254286095295e-1, 1.859935499655997480824e-1,
1.160343707707590030925e-1, 1.669595783380934502273e-1,
1.241214350681454782979e-1, 1.607786111275603313720e-1,
1.342531393234080397304e-1, 1.624531668049217513943e-1,
1.467111042982462503889e-1, 1.698775932996008262098e-1},

{ x0 = pi/5, eps = 1887*eps,
7.386329815077428836852e-1, 1.652303129589020835327  ,
1.715375959434274110004   , 3.284510474542708469542  ,
6.531994069673224499456   , 1.410634456868579696314e1,
3.160325861399778552844e1 , 7.289363723968803052871e1,
1.715969414308485022577e2 , 4.103836427793029505806e2,
9.937124820106729153403e2 , 2.430509681998777873581e3,
5.994291221859571335388e3 , 1.488691928537599456922e4,
3.719197477617681851103e4 , 9.339316781811942532911e4},

}

M.fun.acoth = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

{ x0 = 1.001, eps = 359*eps, -- inaccurate (inf @ 1)
3.8007011672919475, -499.7501249376082, 249999.9375625301, -1.666666666459415e8,
1.2500000000006914e11, -1.000000000000769e14, 8.333333333341027e16,
-7.142857142864836e19, 6.250000000007694e22, -5.555555555563249e25,
5.000000000007694e28, -4.545454545462238e31, 4.166666666674361e34,
-3.8461538461615385e37, 3.571428571436265e40, -3.3333333333410277e43},

{ x0 = 1.1, eps = 205*eps, -- SSE2: eps = 116*eps, -- inaccurate (inf @ 1)
1.5222612188617113, -4.761904761904759, 24.943310657596346, -166.64867005003032,
1249.9935726369129, -9999.997551480703, 83333.33236169843, -714285.713889126,
6.249999999834727e6, -5.5555555555485316e7, 4.999999999999671e8,
-4.545454545454502e9, 4.1666666666666374e10, -3.846153846153817e11,
3.5714285714285425e12, -3.333333333333305e13},

{ x0 = 2,
0.5493061443340549, -0.3333333333333333, 0.2222222222222222,
-0.16049382716049382, 0.12345679012345678, -0.09958847736625515,
0.08321902149062643, -0.07139591090208375, 0.062490474013107755,
-0.055552733040920815, 0.04999915324560958, -0.04545428886230593,
0.041666588263482365, -0.03846151433748175, 0.03571427824731578,
-0.033333331010276024},

{ x0 = 10,
0.10033534773107558, -0.010101010101010102, 0.001020304050607081,
-0.00010340455193021258, 0.000010514305592420688, -1.0725874577838735e-6,
1.0976687442542861e-7, -1.1268524736121307e-8, 1.1603437077075902e-9,
-1.1983762074115067e-10, 1.2412143506814549e-11, -1.2891552935652465e-12,
1.3425313932340804e-13, -1.4017129144056114e-14, 1.4671110429824625e-15,
-1.539181233416566e-16},

{ x0 = pi/3, eps = 406*eps, -- SSE2: eps = 322*eps, -- inaccurate (inf @ 1)
1.8849425394276074, -10.349533637048816, 112.16831056110983, -1585.203523647585,
25190.223766744297, -426975.2151219926, 7.538795393224731e6,
-1.3691016715667674e8, 2.5381909278194275e9, -4.780268586858546e10,
9.115391835165442e11, -1.755752076126305e13, 3.4100061598784756e14,
-6.669197689139604e15, 1.3121075709699206e17, -2.5946976100606213e18},

}

M.fun.erf = {
neg = \x,i -> is_odd(i) and -x or x, -- odd function

{ x0 = 0,
0, 1.1283791670955126, 0, -0.3761263890318375, 0, 0.11283791670955126, 0,
-0.02686617064513125, 0, 0.005223977625442187, 0, -0.0008548327023450852, 0,
0.00012055332981789664, 0, -0.000014925650358406252},

{ x0 = 0.001,
0.0011283787909692367, 1.1283780387169096, -0.0011283780387169096,
-0.37612526065361074, 0.0005641886432324419, 0.11283735252062595,
-0.00018806275570219317, -0.026865982582218832, 0.00004701565758173896,
0.005223930609729755, -9.403125247588432e-6, -0.000854823299205733,
1.5671864964719303e-6, 0.000120551762628527, -2.2388363595421996e-7,
-0.000014925426474285215},

{ x0 = 0.1,
0.1124629160182849, 1.1171516067889369, -0.1117151606788937,
-0.3649361915510527, 0.05548519647051721, 0.10726144960649514,
-0.01837143404568776, -0.025013542266907756,  0.004562074423605785,
0.0047623648980408256, -0.0009062827510462894, -0.0007628182060240208,
0.00015002920510741392, 0.0001052687848735299, -0.000021287910787083036,
-0.000012749439316704496},

{ x0 = 1,
0.8427007929497149, 0.4151074974205947, -0.4151074974205947, 0.1383691658068649,
0.06918458290343245, -0.06918458290343245, 0.0046123055268954966,
0.01515471815979949, -0.004777030724284622, -0.0018851883701199847,
0.0012262875805634853, 0.00008552399137172747, -0.0002000551471321796,
0.00001871663923714299, 0.000023707092917618642, -5.478243913614476e-6},

{ x0 = 10,
1, 4.197656231354417e-44, -4.197656231354417e-43, 2.7844453001317632e-42,
-1.3782304626280336e-41, 5.429388491508182e-41, -1.7730433514993129e-40,
4.936566992581175e-40, -1.196147962041737e-39, 2.5621177796814487e-39,
-4.9115870327776996e-39, 8.510902604738852e-39, -1.3440657821113586e-38,
1.9477679613865425e-38, -2.6052862153287277e-38, 3.232562729980922e-38},

{ x0 = pi/5,
0.6257693217439263, 0.7603306014282829, -0.47772980634932055,
-0.05333254047237432, 0.17599818051763597, -0.028233405135037744,
-0.04101965759416566, 0.014086071029328968, 0.006577291764137021,
-0.0036573214328908333, -0.0007097037478089057, 0.0006795471464854671,
0.00003636886010791556, -0.00009934914559362631, 4.121664814748871e-6,
0.000011955074622761255},

{ x0 = pi/3,
0.8613830281602637, 0.3768754665352764, -0.39466306566181675,
0.14990164176077223, 0.053066039134490414, -0.06719874302156814,
0.009305842609361093, 0.013215399121608452, -0.005453892530135882,
-0.001300482517635482, 0.0012419533158147516, -0.00002366112820904883,
-0.00018404509890057266, 0.00003298783760051966, 0.00001933471440657045,
-6.783843875445751e-6},

}

-- end ------------------------------------------------------------------------o

return M
